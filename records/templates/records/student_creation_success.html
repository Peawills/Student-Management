{% extends "records/base.html" %}
{% load static %}

{% block title %}Student Created Successfully{% endblock %}

{% block extra_css %}
<!-- No extra CSS needed, using Tailwind utilities -->
{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto my-8 bg-white p-8 rounded-2xl shadow-lg text-center">
    <div class="w-24 h-24 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center">
        <i class="bi bi-check-circle-fill text-5xl text-green-500"></i>
    </div>
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Student Created Successfully!</h1>
    <p class="text-gray-600 mb-8">
        The portal login details for <strong>{{ student.full_name }}</strong> and their parent have been generated.
    </p>

    <!-- Student Credentials -->
    <div class="bg-gray-50 border border-gray-200 rounded-xl p-6 mb-6 text-left">
        <h4 class="font-bold text-primary-600 mb-4 flex items-center gap-2"><i class="bi bi-person-fill"></i>Student
            Login Details</h4>
        <div class="space-y-3">
            <div class="flex justify-between items-center pb-3 border-b">
                <strong class="text-gray-600">Username:</strong>
                <span class="font-mono bg-gray-200 text-gray-800 px-3 py-1 rounded-md font-semibold">{{
                    student_login.username }}</span>
            </div>
            <div class="flex justify-between items-center">
                <strong class="text-gray-600">Password:</strong>
                <span class="font-mono bg-gray-200 text-gray-800 px-3 py-1 rounded-md font-semibold">{{
                    student_login.password }}</span>
            </div>
        </div>
    </div>

    <!-- Parent Credentials -->
    {% if parent_invitation_url %}
    <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 text-left">
        <h4 class="font-bold text-blue-600 mb-4 flex items-center gap-2"><i
                class="bi bi-envelope-paper-heart"></i>Parent Invitation Link</h4>
        <p class="text-blue-800 mb-4 text-sm">Please share the following secure link with the parent
            (<strong>{{ student.father_name }}</strong>) to allow them to create their portal account:</p>
        <div class="flex">
            <input type="text"
                class="flex-grow bg-white border border-gray-300 rounded-l-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                value="{{ parent_invitation_url }}" id="invitationLink" readonly>
            <button
                class="bg-blue-600 text-white px-4 py-2 rounded-r-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
                type="button" onclick="copyLink()" id="copyBtn">
                <i class="bi bi-clipboard"></i>
                <span id="copyBtnText">Copy</span>
            </button>
        </div>
    </div>
    {% endif %}

    <div class="flex justify-center gap-4 mt-10 flex-wrap">
        <a href="{% url 'records:student_detail' student.pk %}"
            class="inline-flex items-center gap-2 px-6 py-2.5 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors">
            <i class="bi bi-person-lines-fill"></i> View Student Profile
        </a>
        <a href="{% url 'records:student_create' %}"
            class="inline-flex items-center gap-2 px-6 py-2.5 bg-primary-600 text-white font-semibold rounded-lg hover:bg-primary-700 transition-colors">
            <i class="bi bi-plus-circle"></i> Add Another Student
        </a>
    </div>
</div>

<script>
    function copyLink() {
        const linkInput = document.getElementById('invitationLink');
        const copyBtnText = document.getElementById('copyBtnText');
        linkInput.select();
        document.execCommand('copy');

        copyBtnText.textContent = 'Copied!';
        setTimeout(() => {
            copyBtnText.textContent = 'Copy';
        }, 2000);
    }
</script>
{% endblock %}
            </div>
        </div>
    </div>
    {% endif %}

    <div class="action-buttons">
        <a href="{% url 'records:student_detail' student.pk %}" class="btn btn-secondary btn-action"><i class="bi bi-person-lines-fill"></i> View Student Profile</a>
        <a href="{% url 'records:student_create' %}" class="btn btn-primary btn-action"><i class="bi bi-plus-circle"></i> Add Another Student</a>
    </div>
</div>
{% endblock %}